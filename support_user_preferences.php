<?php
ini_set('display errors	', true);
if(!define('sugarEntry')) define('sugarEntry', true);
require_once('include/entryPoint.php');


global $db;
$lquery = "SELECT DISTINCT u.id AS id, u.user_name as user_name
FROM acl_roles ar
JOIN acl_roles_users aru ON aru.role_id = ar.id AND aru.deleted=0
JOIN users u ON u.id = aru.user_id
WHERE ar.deleted =0
AND ar.id =  '7e940722-0a3d-f825-c60d-58fb063144e7'
AND u.deleted =0";
//~ $lquery = "SELECT DISTINCT u.id AS id, u.user_name as user_name
//~ FROM acl_roles ar
//~ JOIN acl_roles_users aru ON aru.role_id = ar.id AND aru.deleted=0
//~ JOIN users u ON u.id = aru.user_id
//~ WHERE ar.deleted =0
//~ AND ar.id =  'a8ab8653-5860-d896-7a78-58466a429bee'
//~ AND u.deleted =0";
//~ $lquery = "SELECT DISTINCT u.id AS id, u.user_name as user_name
//~ FROM acl_roles ar
//~ JOIN acl_roles_users aru ON aru.role_id = ar.id AND aru.deleted=0
//~ JOIN users u ON u.id = aru.user_id
//~ WHERE ar.deleted =0
//~ AND ar.id =  '255c657f-6c02-c252-ebf6-585782eabadf'
//~ AND u.deleted =0 and u.user_name!='Poorti'";
$i = 1;
$result1 = $db->query($lquery);
while($row1 = $db->fetchByAssoc($result1)){
	
	echo $rec_id = $row1['id']; 
	
	echo  ' 	' . $row1['user_name'] . ' 		';
	
	echo '<br>';
	
	$up_query = "select count(id) as id from user_preferences where assigned_user_id = '$rec_id' and deleted = 0 and category = 'Home'";
	$up_result = $db->query($up_query);
	while($row = $db->fetchByAssoc($up_result)){
		
		$update_branch = "update user_preferences set deleted = '1' where category = 'Home' and deleted = 0 and assigned_user_id = '$rec_id'";
		
		$db->query($update_branch);
		
	}
	
		
		$id = create_guid();
		
	//$query = "insert into user_preferences(id,category, deleted, date_entered, date_modified, assigned_user_id, contents) values('$id' , 'Home' , '0' , Now() , Now(), '$rec_id' , 'YToyOntzOjg6ImRhc2hsZXRzIjthOjM6e3M6MzY6ImQ4MGY4ODczLTNmZjctMDg1ZC1mYTkyLTU4NTNlOWE5OWYzNyI7YTo1OntzOjk6ImNsYXNzTmFtZSI7czoxNDoiTXlDYWxsc0Rhc2hsZXQiO3M6NjoibW9kdWxlIjtzOjU6IkNhbGxzIjtzOjExOiJmb3JjZUNvbHVtbiI7aTowO3M6MTI6ImZpbGVMb2NhdGlvbiI7czo1NjoibW9kdWxlcy9DYWxscy9EYXNobGV0cy9NeUNhbGxzRGFzaGxldC9NeUNhbGxzRGFzaGxldC5waHAiO3M6Nzoib3B0aW9ucyI7YTo2OntzOjc6ImZpbHRlcnMiO2E6Mzp7czo2OiJzdGF0dXMiO2E6MTp7aTowO3M6NzoiUGxhbm5lZCI7fXM6MTI6ImRhdGVfZW50ZXJlZCI7YTowOnt9czoxMDoiZGF0ZV9zdGFydCI7YToxOntzOjQ6InR5cGUiO3M6ODoiVFBfdG9kYXkiO319czo1OiJ0aXRsZSI7czoyMDoiVG9kYXkgQXNzaWduZWQgQ2FsbHMiO3M6MTE6Im15SXRlbXNPbmx5IjtzOjQ6InRydWUiO3M6MTE6ImRpc3BsYXlSb3dzIjtzOjE6IjUiO3M6MTQ6ImRpc3BsYXlDb2x1bW5zIjthOjY6e2k6MDtzOjEyOiJzZXRfY29tcGxldGUiO2k6MTtzOjQ6Im5hbWUiO2k6MjtzOjExOiJwYXJlbnRfbmFtZSI7aTozO3M6MTA6ImRhdGVfc3RhcnQiO2k6NDtzOjE2OiJzZXRfYWNjZXB0X2xpbmtzIjtpOjU7czo2OiJzdGF0dXMiO31zOjExOiJhdXRvUmVmcmVzaCI7czoyOiItMSI7fX1zOjM2OiJhNjdjZDY2Yi04MTFlLTQ3NDItN2YyOS01ODU3ZTA4MGQ2ZDYiO2E6NTp7czo5OiJjbGFzc05hbWUiO3M6MTc6Ik15Q29udGFjdHNEYXNobGV0IjtzOjY6Im1vZHVsZSI7czo4OiJDb250YWN0cyI7czo3OiJvcHRpb25zIjthOjY6e3M6NzoiZmlsdGVycyI7YTozOntzOjEyOiJkYXRlX2VudGVyZWQiO2E6MDp7fXM6MjI6InVzZXJfYWxsb2NhdGlvbl9kYXRlX2MiO2E6MTp7czo0OiJ0eXBlIjtzOjg6IlRQX3RvZGF5Ijt9czoxMzoiZGlzcG9zaXRpb25fYyI7YToxOntpOjA7czowOiIiO319czo1OiJ0aXRsZSI7czoyMDoiVG9kYXkgQXNzaWduZWQgVXNlcnMiO3M6MTE6Im15SXRlbXNPbmx5IjtzOjQ6InRydWUiO3M6MTE6ImRpc3BsYXlSb3dzIjtzOjI6IjEwIjtzOjE0OiJkaXNwbGF5Q29sdW1ucyI7YTo2OntpOjA7czo0OiJuYW1lIjtpOjE7czoxMjoicGhvbmVfbW9iaWxlIjtpOjI7czo2OiJlbWFpbDEiO2k6MztzOjEzOiJzYWxlc19zdGFnZV9jIjtpOjQ7czoyMjoidXNlcl9hbGxvY2F0aW9uX2RhdGVfYyI7aTo1O3M6MTI6ImRhdGVfZW50ZXJlZCI7fXM6MTE6ImF1dG9SZWZyZXNoIjtzOjI6IjMwIjt9czoxMjoiZmlsZUxvY2F0aW9uIjtzOjY1OiJtb2R1bGVzL0NvbnRhY3RzL0Rhc2hsZXRzL015Q29udGFjdHNEYXNobGV0L015Q29udGFjdHNEYXNobGV0LnBocCI7czoxMjoic29ydF9vcHRpb25zIjthOjI6e3M6OToic29ydE9yZGVyIjtzOjQ6ImRlc2MiO3M6Nzoib3JkZXJCeSI7czoyMjoidXNlcl9hbGxvY2F0aW9uX2RhdGVfYyI7fX1zOjM2OiJkNDYyZWM3ZS00NTg2LWU5MDYtMGUzNi01ODU4ZTE1YzBhMTEiO2E6NDp7czo5OiJjbGFzc05hbWUiO3M6MTc6Ik15Q29udGFjdHNEYXNobGV0IjtzOjY6Im1vZHVsZSI7czo4OiJDb250YWN0cyI7czo3OiJvcHRpb25zIjthOjY6e3M6NzoiZmlsdGVycyI7YTozOntzOjEyOiJkYXRlX2VudGVyZWQiO2E6MDp7fXM6MjI6InVzZXJfYWxsb2NhdGlvbl9kYXRlX2MiO2E6MDp7fXM6MjQ6Im9ubGluZV9hY3Rpdml0eV9zdGF0dXNfYyI7YToxOntpOjA7czo2OiJBY3RpdmUiO319czo1OiJ0aXRsZSI7czoxMjoiQWN0aXZlIFVzZXJzIjtzOjExOiJteUl0ZW1zT25seSI7czo0OiJ0cnVlIjtzOjExOiJkaXNwbGF5Um93cyI7czoxOiI1IjtzOjE0OiJkaXNwbGF5Q29sdW1ucyI7YTo2OntpOjA7czo0OiJuYW1lIjtpOjE7czoxMjoicGhvbmVfbW9iaWxlIjtpOjI7czo2OiJlbWFpbDEiO2k6MztzOjEzOiJzYWxlc19zdGFnZV9jIjtpOjQ7czoxODoiYXNzaWduZWRfdXNlcl9uYW1lIjtpOjU7czoyMjoidXNlcl9hbGxvY2F0aW9uX2RhdGVfYyI7fXM6MTE6ImF1dG9SZWZyZXNoIjtzOjI6IjMwIjt9czoxMjoiZmlsZUxvY2F0aW9uIjtzOjY1OiJtb2R1bGVzL0NvbnRhY3RzL0Rhc2hsZXRzL015Q29udGFjdHNEYXNobGV0L015Q29udGFjdHNEYXNobGV0LnBocCI7fX1zOjU6InBhZ2VzIjthOjE6e2k6MDthOjM6e3M6NzoiY29sdW1ucyI7YToyOntpOjA7YToyOntzOjU6IndpZHRoIjtzOjM6IjYwJSI7czo4OiJkYXNobGV0cyI7YToyOntpOjM7czozNjoiYTY3Y2Q2NmItODExZS00NzQyLTdmMjktNTg1N2UwODBkNmQ2IjtpOjQ7czozNjoiZDQ2MmVjN2UtNDU4Ni1lOTA2LTBlMzYtNTg1OGUxNWMwYTExIjt9fWk6MTthOjI6e3M6NToid2lkdGgiO3M6MzoiNDAlIjtzOjg6ImRhc2hsZXRzIjthOjE6e2k6MDtzOjM2OiJkODBmODg3My0zZmY3LTA4NWQtZmE5Mi01ODUzZTlhOTlmMzciO319fXM6MTA6Im51bUNvbHVtbnMiO3M6MToiMyI7czoxNDoicGFnZVRpdGxlTGFiZWwiO3M6MjA6IkxCTF9IT01FX1BBR0VfMV9OQU1FIjt9fX0=')";
		$query = "insert into user_preferences(id,category, deleted, date_entered, date_modified, assigned_user_id, contents) values('$id' , 'Home' , '0' , Now() , Now(), '$rec_id' , 'YToyOntzOjg6ImRhc2hsZXRzIjthOjQ6e3M6MzY6ImIyOTFmMTgyLTc0MmMtNjM0NS1jODNhLTU4ZDBlZDVlOWNmOSI7YTo0OntzOjk6ImNsYXNzTmFtZSI7czoxNDoiTXlDYXNlc0Rhc2hsZXQiO3M6NjoibW9kdWxlIjtzOjU6IkNhc2VzIjtzOjc6Im9wdGlvbnMiO2E6Njp7czo3OiJmaWx0ZXJzIjthOjM6e3M6MTI6ImRhdGVfZW50ZXJlZCI7YTowOnt9czo2OiJzdGF0dXMiO2E6MTp7aTowO3M6MTE6Ik9wZW5fUmVvcGVuIjt9czoxMzoiZGF0ZV9tb2RpZmllZCI7YToxOntzOjQ6InR5cGUiO3M6ODoiVFBfdG9kYXkiO319czo1OiJ0aXRsZSI7czoyMDoiVG9kYXkgUmVvcGVuIFRpY2tldHMiO3M6MTE6Im15SXRlbXNPbmx5IjtiOjA7czoxMToiZGlzcGxheVJvd3MiO3M6MToiNSI7czoxNDoiZGlzcGxheUNvbHVtbnMiO2E6Njp7aTowO3M6MTE6ImNhc2VfbnVtYmVyIjtpOjE7czo0OiJuYW1lIjtpOjI7czo4OiJwcmlvcml0eSI7aTozO3M6Njoic3RhdHVzIjtpOjQ7czoxODoiYXNzaWduZWRfdXNlcl9uYW1lIjtpOjU7czoxMjoiZGF0ZV9lbnRlcmVkIjt9czoxMToiYXV0b1JlZnJlc2giO3M6MjoiMzAiO31zOjEyOiJmaWxlTG9jYXRpb24iO3M6NTY6Im1vZHVsZXMvQ2FzZXMvRGFzaGxldHMvTXlDYXNlc0Rhc2hsZXQvTXlDYXNlc0Rhc2hsZXQucGhwIjt9czozNjoiNGY2NzI3NDMtYjJjYS1lZjliLWNkYWUtNThkMGVlZWI4MWQyIjthOjQ6e3M6OToiY2xhc3NOYW1lIjtzOjE0OiJNeUNhc2VzRGFzaGxldCI7czo2OiJtb2R1bGUiO3M6NToiQ2FzZXMiO3M6Nzoib3B0aW9ucyI7YTo2OntzOjc6ImZpbHRlcnMiO2E6Mzp7czoxMjoiZGF0ZV9lbnRlcmVkIjthOjE6e3M6NDoidHlwZSI7czo4OiJUUF90b2RheSI7fXM6Njoic3RhdHVzIjthOjE6e2k6MDtzOjE1OiJPcGVuX1JlYXNzaWduZWQiO31zOjEzOiJkYXRlX21vZGlmaWVkIjthOjA6e319czo1OiJ0aXRsZSI7czoyMjoiVG9kYXkgUmVhc3NpZ24gVGlja2V0cyI7czoxMToibXlJdGVtc09ubHkiO2I6MDtzOjExOiJkaXNwbGF5Um93cyI7czoxOiI1IjtzOjE0OiJkaXNwbGF5Q29sdW1ucyI7YTo2OntpOjA7czoxMToiY2FzZV9udW1iZXIiO2k6MTtzOjQ6Im5hbWUiO2k6MjtzOjg6InByaW9yaXR5IjtpOjM7czo2OiJzdGF0dXMiO2k6NDtzOjE4OiJhc3NpZ25lZF91c2VyX25hbWUiO2k6NTtzOjE1OiJhc3NpZ25lZF90aW1lX2MiO31zOjExOiJhdXRvUmVmcmVzaCI7czoyOiIzMCI7fXM6MTI6ImZpbGVMb2NhdGlvbiI7czo1NjoibW9kdWxlcy9DYXNlcy9EYXNobGV0cy9NeUNhc2VzRGFzaGxldC9NeUNhc2VzRGFzaGxldC5waHAiO31zOjM2OiJlZTIxNDkxNy1hMjg5LWE5MGEtMzJlZS01OGQwZWU5NmVhM2EiO2E6NTp7czo5OiJjbGFzc05hbWUiO3M6MTQ6Ik15Q2FzZXNEYXNobGV0IjtzOjY6Im1vZHVsZSI7czo1OiJDYXNlcyI7czo3OiJvcHRpb25zIjthOjY6e3M6NzoiZmlsdGVycyI7YToyOntzOjEyOiJkYXRlX2VudGVyZWQiO2E6MTp7czo0OiJ0eXBlIjtzOjg6IlRQX3RvZGF5Ijt9czo2OiJzdGF0dXMiO2E6MTp7aTowO3M6ODoiT3Blbl9OZXciO319czo1OiJ0aXRsZSI7czoxODoiVG9kYXkgT3BlbiBUaWNrZXRzIjtzOjExOiJteUl0ZW1zT25seSI7czo0OiJ0cnVlIjtzOjExOiJkaXNwbGF5Um93cyI7czoxOiI1IjtzOjE0OiJkaXNwbGF5Q29sdW1ucyI7YTo2OntpOjA7czoxMToiY2FzZV9udW1iZXIiO2k6MTtzOjQ6Im5hbWUiO2k6MjtzOjg6InByaW9yaXR5IjtpOjM7czo2OiJzdGF0dXMiO2k6NDtzOjE4OiJhc3NpZ25lZF91c2VyX25hbWUiO2k6NTtzOjEyOiJkYXRlX2VudGVyZWQiO31zOjExOiJhdXRvUmVmcmVzaCI7czoyOiIzMCI7fXM6MTI6ImZpbGVMb2NhdGlvbiI7czo1NjoibW9kdWxlcy9DYXNlcy9EYXNobGV0cy9NeUNhc2VzRGFzaGxldC9NeUNhc2VzRGFzaGxldC5waHAiO3M6MTI6InNvcnRfb3B0aW9ucyI7YToyOntzOjk6InNvcnRPcmRlciI7czo0OiJkZXNjIjtzOjc6Im9yZGVyQnkiO3M6MTI6ImRhdGVfZW50ZXJlZCI7fX1zOjM2OiIxMmNjMzcyNi01MDI0LTVlMTMtM2Q5NC01OGQwZWU5OWRjZWQiO2E6NTp7czo5OiJjbGFzc05hbWUiO3M6MTQ6Ik15Q2FzZXNEYXNobGV0IjtzOjY6Im1vZHVsZSI7czo1OiJDYXNlcyI7czo3OiJvcHRpb25zIjthOjY6e3M6NzoiZmlsdGVycyI7YToyOntzOjEyOiJkYXRlX2VudGVyZWQiO2E6MTp7czo0OiJ0eXBlIjtzOjg6IlRQX3RvZGF5Ijt9czo2OiJzdGF0dXMiO2E6MTp7aTowO3M6MTQ6Ik9wZW5fRXNjYWxhdGVkIjt9fXM6NToidGl0bGUiO3M6MjM6IlRvZGF5IEVzY2FsYXRlZCBUaWNrZXRzIjtzOjExOiJteUl0ZW1zT25seSI7YjowO3M6MTE6ImRpc3BsYXlSb3dzIjtzOjE6IjUiO3M6MTQ6ImRpc3BsYXlDb2x1bW5zIjthOjY6e2k6MDtzOjExOiJjYXNlX251bWJlciI7aToxO3M6NDoibmFtZSI7aToyO3M6ODoicHJpb3JpdHkiO2k6MztzOjY6InN0YXR1cyI7aTo0O3M6MTg6ImFzc2lnbmVkX3VzZXJfbmFtZSI7aTo1O3M6MTI6ImRhdGVfZW50ZXJlZCI7fXM6MTE6ImF1dG9SZWZyZXNoIjtzOjI6IjMwIjt9czoxMjoiZmlsZUxvY2F0aW9uIjtzOjU2OiJtb2R1bGVzL0Nhc2VzL0Rhc2hsZXRzL015Q2FzZXNEYXNobGV0L015Q2FzZXNEYXNobGV0LnBocCI7czoxMjoic29ydF9vcHRpb25zIjthOjI6e3M6OToic29ydE9yZGVyIjtzOjQ6ImRlc2MiO3M6Nzoib3JkZXJCeSI7czoxMjoiZGF0ZV9lbnRlcmVkIjt9fX1zOjU6InBhZ2VzIjthOjE6e2k6MDthOjM6e3M6NzoiY29sdW1ucyI7YToyOntpOjA7YToyOntzOjU6IndpZHRoIjtzOjM6IjYwJSI7czo4OiJkYXNobGV0cyI7YToyOntpOjA7czozNjoiZWUyMTQ5MTctYTI4OS1hOTBhLTMyZWUtNThkMGVlOTZlYTNhIjtpOjE7czozNjoiMTJjYzM3MjYtNTAyNC01ZTEzLTNkOTQtNThkMGVlOTlkY2VkIjt9fWk6MTthOjI6e3M6NToid2lkdGgiO3M6MzoiNDAlIjtzOjg6ImRhc2hsZXRzIjthOjI6e2k6MDtzOjM2OiI0ZjY3Mjc0My1iMmNhLWVmOWItY2RhZS01OGQwZWVlYjgxZDIiO2k6MTtzOjM2OiJiMjkxZjE4Mi03NDJjLTYzNDUtYzgzYS01OGQwZWQ1ZTljZjkiO319fXM6MTA6Im51bUNvbHVtbnMiO3M6MToiMyI7czoxNDoicGFnZVRpdGxlTGFiZWwiO3M6MjA6IkxCTF9IT01FX1BBR0VfMV9OQU1FIjt9fX0=')";
		
		$result = $db->query($query);
	
		//exit;
}
